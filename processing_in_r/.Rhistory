d=data.frame(x=rnorm(4),y=c('a','a','b','b'))
d
d %>% group_by(y)
d %>% group_by(y) %>% summarise(norm(x))
d %>% group_by(y) %>% summarise(out=norm(x))
?norm
?group_by
d %>% group_by(y) %>% summarise(out=n())
?norm
d %>% group_by(y) %>% summarise(out=sqrt(sum(x^2)))
nu <- 2
f = function(x,nu)
{
(nu+1)*x /(2*(nu+x^2))
}
xas = seq(-4,4,by=0.1)
plot(xas,f(xas),type="l")
nu <- 2
f = function(x,nu)
{
(nu+1)*x /(2*(nu+x^2))
}
xas = seq(-4,4,by=0.1)
plot(xas,f(xas,2),type="l")
nu <- 2
f = function(x,nu)
{
-(nu+1)*x /(2*(nu+x^2))
}
xas = seq(-4,4,by=0.1)
plot(xas,f(xas,2),type="l")
nu <- 2
f = function(x,nu)
{
-(nu+1)*x /(2*(nu+x^2))
}
xas = seq(-4,4,by=0.1)
plot(xas,f(xas,100),type="l")
xas = seq(-10,10,by=0.1)
plot(xas,f(xas,100),type="l")
plot(xas,f(xas,10),type="l")
xas = seq(-30,30,by=0.1)
plot(xas,f(xas,10),type="l")
plot(xas,f(xas,2),type="l")
xx=df(x=rand(100))
xx=df(x=runif(100))
xx=data.frame(x=runif(100))
xx
xx %>% slice(1:10:n())
library(tidyverse)
xx=data.frame(x=runif(100))
xx %>% slice(1:10:n())
xx %>% slice(1:10:100
)
xx %>% slice(2)
xx %>% slice(2:5)
xx %>% slice(seq(1:10,100))
xx %>% slice(seq(1,10,100))
xx %>% slice(1:10:100)
xx %>% slice(seq(1,100,10))
density(runif(100))
a=density(runif(100))
class(a)
methods(a)
str(a)
a.x
a$x
a$y
str(a)
?density
?geom_density
?geom_vline
?geom_histogram
?ggsave
20/1100
days <- 1:10
cases <- 1708*1.2^days
plot(days,cases)
days <- 1:21
plot(days,cases)
cases <- 1708*1.2^days
plot(days,cases)
45/1700
?geom_smooth
library(ggplot2)
?geom_smooth
?geom_abline
d <- read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv")
library(readr)
d <- read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv")
View(d)
plot(d$rad)
plot(d$temp)
glimpse(d)
glimpse(d)
library(DataExplorer)
glimpse(d)
??glimpse
?glimpse
library(tibble)
glimpse(d)
plot(d[,4])
plot(d[,5])
plot(d[,5])
d <- read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv")
View(d)
d <- read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv")
plot(d[,5])
summary(d[,5])
str(d)
d <-  read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv",
col_types = cols(chl = col_double()))
View(d)
glimpse(d)
plot(d[,5])
plot(d[,4])
library(readr)
library(tidyverse)
library(DataExplorer)
library(tibble)
library(readr)
daily_data <- read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv")
View(daily_data)
d <-  read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv",
col_types = cols(chl = col_double()))
View(d)
glimpse(d)
plot(d[,2])
ts.plot(d[,2])
?make_datetime
d
plot(d[,1])
plot(d[,2])
plot(d[,1],d[,2])
tail(d)
ts.plot(d[,2])
?as.Date
plot(d$time, d[,2])
?plot
ggplot(d$time, d[,2])
d %>% ggplot(aes(x=time, yh=chl) + geom_point()
d %>% ggplot(aes(x=time, yh=chl)) + geom_point()
d %>% ggplot(aes(x=time, y=chl)) + geom_point()
names(d)
d <-  read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv",
col_types = cols(chl = col_double())) %>% transmute(chl_water=concentration_of_chlorophyll_in_water)
d
d <-  read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv",
col_types = cols(chl = col_double())) %>% mutate(chl_water=concentration_of_chlorophyll_in_water)
d %>% gather(key='meastype', value=value)
d %>% gather(chl, chl_water,key='meastype', value=value)
?rename
d <-  read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv",
col_types = cols(chl = col_double())) %>% rename(chl_water=concentration_of_chlorophyll_in_water)
d
d %>% gather(chl, chl_water,key='meastype', value=value)
d %>% d %>% gather(chl, chl_water,key='meastype', value=y)
d <- d %>% gather(chl, chl_water,key='meastype', value=y)
d <-  read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv",
col_types = cols(chl = col_double())) %>% rename(chl_water=concentration_of_chlorophyll_in_water)
d <- d %>% gather(chl, chl_water,key='meastype', value=y)
glimpse(d)
d %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% slice(-seq(1,2010)) %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% slice(-seq(1,10010)) %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% slice(-seq(1,8000)) %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% slice(-seq(1,8000)) %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% slice(seq(1,8000)) %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% slice(seq(1,800)) %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% filter(meastype='chl') %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% filter(meastype=='chl') %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point()
d %>% filter(meastype=='chl') %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point() + facet_warp(~meastype)
d %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype)
d %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1)
head(d)
d$time[1]
?difftime
d <- d %>% mutate(time_elapsed = difftime(time, firsttime))
firsttime <- "1976-01-13"
d <- d %>% mutate(time_elapsed = difftime(time, firsttime))
d
d <- d %>% mutate(time_elapsed = difftime(time, firsttime, units='days'))
d
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1)
d <- d %>% mutate(time_elapsed = difftime(time, firsttime, units='years'))
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1)
interval(d$time, firsttime) %>%as.numeric('years')
library(lubridate)
interval(d$time, firsttime) %>%as.numeric('years')
interval(firsttime, d$time) %>%as.numeric('years')
firsttime <- "1976-01-13"
elapsed <- interval(firsttime, d$time) %>%as.numeric('years')
d <- d %>% mutate(time_elapsed = elapsed)
d
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1)
firsttime <- "1976-01-01"
elapsed <- interval(firsttime, d$time) %>%as.numeric('years')
d <- d %>% mutate(time_elapsed = elapsed)
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1)
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1,scales='free')
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=2,scales='free')
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1,scales='free')
d
plot(diff(d$time_elapsed))
plot(diff(d$time_elapsed),ylim=c(0,0.05))
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1,scales='free')
setwd("~/Sync/sync desktop/vraagrob")
# FMS log clean up
setwd("~/Sync/sync desktop/vraagrob")
library(readxl)
source("dsp1.R")
# FMS log clean up
setwd("~/Sync/sync desktop/vraagrob")
source("dsp1.R")
FSMEventlog <- read_excel("FSMEventlog.xlsx",
col_types = c("text", "text", "date",
"text", "date", "date", "text", "text",
"text", "text", "text", "text", "text",
"text", "text", "text", "text", "text",
"text", "text", "text", "numeric",
"numeric", "numeric"))
# FMS log clean up
setwd("~/Sync/sync desktop/vraagrob")
source("dsp1.R")
# inlezen FSM Event log
FSMEventlog <- read_excel("FSMEventlog.xlsx",
col_types = c("text", "text", "date",
"text", "date", "date", "text", "text",
"text", "text", "text", "text", "text",
"text", "text", "text", "text", "text",
"text", "text", "text", "numeric",
"numeric", "numeric"))
library(readxl)
# inlezen FSM Event log
FSMEventlog <- read_excel("FSMEventlog.xlsx",
col_types = c("text", "text", "date",
"text", "date", "date", "text", "text",
"text", "text", "text", "text", "text",
"text", "text", "text", "text", "text",
"text", "text", "text", "numeric",
"numeric", "numeric"))
FSMEventlog01 <- read_excel("FSMEventlog01.xlsx")
FSMEventlog01 <- read_excel("FSMEventlog01.xlsx") %>% slice(1:1000)
View(FSMEventlog01)
FSMEventlog <- read_excel("FSMEventlog01.xlsx") %>% slice(1:1000)
# 1. separeren tekst in Activity
FSMEL01 <- separate(FSMEventlog, Activity, c("ACTA" , "ACTB"), sep = " assigned to ", remove = FALSE)
FSMEL02 <- FSMEL01 %>%
mutate(ACTA=str_replace_all(ACTA, "PO was$", "PO was assigned for approval"))
FSMEL03 <- FSMEL02 %>%
mutate(ACTA=str_replace_all(ACTA, "PR was$", "PR was assigned for approval"))
FSMEL04 <- FSMEL03 %>%
mutate(ACTA=str_replace_all(ACTA, "PF was$", "PF was assigned for approval"))
FSMEL05 <- FSMEL04[-c(2,4)]
FSMEL05 <-
separate(FSMEL05, ACTA, c("ACTAA" , "ACTB"), sep = " approved ", remove = FALSE)
FSMEL05 <- FSMEL05[-c(2)]
FSMEL05 <- FSMEL05[-c(2)]
View(FSMEL05)
d <- FSMEL05
d <- FSMEL05
glimpse(d)
unique(d$ACTB)
FSMEL02 <- FSMEL01 %>%
mutate(ACTA=str_replace_all(ACTA, "PO was$", "PO was assigned for approval"))
FSMEL03 <- FSMEL02 %>%
mutate(ACTA=str_replace_all(ACTA, "PR was$", "PR was assigned for approval"))
FSMEL04 <- FSMEL03 %>%
mutate(ACTA=str_replace_all(ACTA, "PF was$", "PF was assigned for approval"))
FSMEL05 <- FSMEL04[-c(2,4)]
# 2. with limit anonimiseren
FSMEL05 <-
separate(FSMEL05, ACTA, c("ACTAA" , "ACTB"), sep = " approved ", remove = FALSE)
View(FSMEL05)
d <- FSMEL05
d1 <- FSMEL05 %>% filter(!is.na(ACTB))
View(d1)
d1 <- FSMEL05 %>% filter(!is.na(ACTB)) %>% mutate(ACTAA = ACTB)
View(d1)
?bind_rows
dcomb <- bind_rows(d1,d2)
d2 <- FSMEL05 %>% filter(is.na(ACTB))
dcomb <- bind_rows(d1,d2)
View(dcomb)
glimpse(dcomb)
d %>% mutate(ncol = ifelse(is.na(ACTB), ACTAA, ACTB))
dd <- d %>% mutate(ncol = ifelse(is.na(ACTB), ACTAA, ACTB))
View(dd)
library(readr)
library(tidyverse)
library(DataExplorer)
library(tibble)
library(lubridate)
setwd("~/Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion")
dorig <-  read_csv("Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion/daily_data.csv",
col_types = cols(chl = col_double())) %>% rename(chl_water=concentration_of_chlorophyll_in_water)
setwd("~/Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion")
library(readr)
library(tidyverse)
library(DataExplorer)
library(tibble)
library(lubridate)
setwd("~/Sync/DOCUMENTS/onderzoek/phd-studenten/lorinc/datafusion")
setwd("~/.julia/dev/Examples/datafusion")
setwd("~/.julia/dev/Examples/datafusion/processing_in_r")
dorig <-  read_csv("daily_data.csv",
col_types = cols(chl = col_double())) %>% rename(chl_water=concentration_of_chlorophyll_in_water)
d <- dorig %>% gather(chl, chl_water,key='meastype', value=y)
glimpse(d)
d %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1)
d %>% filter(meastype=='chl') %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype)
firsttime <- "1976-01-01"
elapsed <- interval(firsttime, d$time) %>%as.numeric('years')
d <- d %>% mutate(time_elapsed = elapsed)
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1,scales='free')
elapsed2 <- interval(firsttime, dorig$time) %>%as.numeric('years')
dorig <- dorig %>% mutate(time_elapsed=elapsed2, chl_water_meas = !is.na(chl_water), chl_meas=!is.na(chl)) %>%
unite("obsscheme", chl_water_meas, chl_meas) %>%
mutate(obsscheme=fct_recode(obsscheme,obs1="TRUE_FALSE", obs2="FALSE_TRUE", obs3="TRUE_TRUE")) %>%
arrange(time_elapsed)
glimpse(dorig)
dorig %>% filter(obsscheme=='type3')
View(dorig)
?png
library(readr)
library(tidyverse)
library(DataExplorer)
library(tibble)
library(lubridate)
setwd("~/.julia/dev/Examples/datafusion/processing_in_r")
dorig <-  read_csv("daily_data.csv",
col_types = cols(chl = col_double())) %>% rename(chl_water=concentration_of_chlorophyll_in_water)
d <- dorig %>% gather(chl, chl_water,key='meastype', value=y)
#View(d)
glimpse(d)
d %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1)
d %>% filter(meastype=='chl') %>% ggplot(aes(x=time, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype)
firsttime <- "1976-01-01"
elapsed <- interval(firsttime, d$time) %>%as.numeric('years')
d <- d %>% mutate(time_elapsed = elapsed)
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1,scales='free')
elapsed2 <- interval(firsttime, dorig$time) %>%as.numeric('years')
dorig <- dorig %>% mutate(time_elapsed=elapsed2, chl_water_meas = !is.na(chl_water), chl_meas=!is.na(chl)) %>%
unite("obsscheme", chl_water_meas, chl_meas) %>%
mutate(obsscheme=fct_recode(obsscheme,obs1="TRUE_FALSE", obs2="FALSE_TRUE", obs3="TRUE_TRUE")) %>%
arrange(time_elapsed)
d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1,scales='free')
d <- d %>% mutate(time_elapsed = elapsed)
pl <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point() + facet_wrap(~meastype,ncol=1,scales='free')
pl
pdf("vis_data.pdf",width=7,height=5)
display(pl)
dev.off()
pdf("vis_data.pdf",width=7,height=5)
pl
dev.off()
pl <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) + facet_wrap(~meastype,ncol=1,scales='free')
pl
pdf("vis_data.pdf",width=7,height=5)
pl
dev.off()
d <- d %>% mutate(time_elapsed = elapsed)
pl <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration")
pl
pdf("vis_data.pdf",width=7,height=5)
pl
dev.off()
pdf("/figs/vis_data.pdf",width=7,height=5)
pl
dev.off()
pdf("./figs/vis_data.pdf",width=7,height=5)
pdf("figs/vis_data.pdf",width=7,height=5)
pdf("/figs/vis_data.pdf",width=7,height=5)
pdf("./figs/vis_data.pdf",width=7,height=5)
pdf("~./figs/vis_data.pdf",width=7,height=5)
pdf("figs/vis_data.pdf",width=7,height=5)
getwd()
pdf("~/.julia/dev/Examples/datafusion/processing_in_r/figs/vis_data.pdf",width=7,height=5)
pdf("~/.julia/dev/Examples/datafusion/figs/vis_data.pdf",width=7,height=5)
pl
dev.off()
# include posterior mean in figure
pm <- read_csv("postmean_paths.csv",
col_names = FALSE)
# include posterior mean in figure
pm <- read_csv("postmean_paths.csv", col_names = FALSE)
pm
dorig
# include posterior mean in figure
pm <- read_csv("postmean_paths.csv", col_names = FALSE) %>% mutate(time_elapsed = dorig$time_elapsed)
pm
pl %>% geom_path(aes(x=time_elapsed,y=X1))
pl + geom_path(aes(x=time_elapsed,y=X1))
pl + geom_path(data=pm, mapping=aes(x=time_elapsed,y=X1))
# include posterior mean in figure
pm <- read_csv("postmean_paths.csv", col_names = FALSE)
pm$X1
dorig %>% mutate(postmean=pm$X1)
pl + geom_path(mapping=aes(x=time_elapsed,y=postmean))
dorig <- dorig %>% mutate(postmean=pm$X1)
pl + geom_path(mapping=aes(x=time_elapsed,y=postmean))
pl + geom_path(mapping=aes(x=time_elapsed,y=postmean))
pl2 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration")+ geom_path(mapping=aes(x=time_elapsed,y=postmean))
pl2
pm$X1
pl <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration")
pl
d <- d %>% mutate(postmean=pm$X1)
pl2 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean))
pl2
d
d <- d %>% mutate(postmean=pm$X1)
pm
pm$X1
d <- d %>% mutate(postmean=pm$X1)
d <- d %>% mutate(postmean=rep(pm$X1,2))
pl2 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean))
pl2
pl2 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean),colour='black')
pl2
pl2 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean),colour='black',size=0.5)
pl2
pl2 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean),colour='black',linewidth=0.5)
pl2 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean),colour='black',size=0.3)
pl2
pl2 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean),colour='grey',size=0.3,alpha=0.8)
pl2
pl2 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean),colour='black',size=0.3,alpha=0.8)
pl2
pdf("~/.julia/dev/Examples/datafusion/figs/vis_data_fit.pdf",width=7,height=5)
pl2
dev.off()
pl3 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
ylab("concentration") +
pl3 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean),colour='black',size=0.3,alpha=0.8)
pl3 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.6) +
ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean),colour='black',size=0.3,alpha=0.8)
pl3
pdf("~/.julia/dev/Examples/datafusion/figs/vis_data_fit2.pdf",width=7,height=5)
pl3
dev.off()
# include posterior mean in figure
pm <- read_csv("postmean_paths.csv", col_names = FALSE)
d <- d %>% mutate(postmean=rep(pm$X1,2))
pl2 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.9) +
facet_wrap(~meastype,ncol=1,scales='free') + ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean),colour='black',size=0.3,alpha=0.8)
pl2
pdf("~/.julia/dev/Examples/datafusion/figs/vis_data_fit.pdf",width=7,height=5)
pl2
dev.off()
pl3 <- d %>% ggplot(aes(x=time_elapsed, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.9) +
ylab("concentration") +
geom_path(mapping=aes(x=time_elapsed,y=postmean),colour='black',size=0.3,alpha=0.8)
pl3
pdf("~/.julia/dev/Examples/datafusion/figs/vis_data_fit2.pdf",width=7,height=5)
pl3
dev.off()
mod(1.5,1)
?mod
1.5 %% 1
d %>% mutate(y1 = y %% 1) %>% ggplot(aes(x=time_elapsed, y=y1,colour=meastype)) + geom_point(size=0.6,alpha=0.9)
d %>% mutate(t1 = time_elapsed %% 1) %>% ggplot(aes(x=t1, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.9)
d %>% mutate(t1 = time_elapsed %% 1) %>% ggplot(aes(x=t1, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.9) + geom_smooth()
d %>% mutate(t1 = time_elapsed %% 1) %>% ggplot(aes(x=t1, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.9) + geom_smooth() + facet_wrap(~meastype)
d %>% mutate(t1 = time_elapsed %% 1) %>% ggplot(aes(x=t1, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.9) + geom_smooth(colour='blue') + facet_wrap(~meastype)
?geom_smooth
?loess
d1 <- d %>% mutate(t1 = time_elapsed %% 1)
d1  %>% ggplot(aes(x=t1, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.9) + geom_smooth(colour='blue') + facet_wrap(~meastype)
loess(y ~t1, d1)
out <- loess(y ~t1, d1)
out
out[1]
class(out)
out$fitted
pl4 <- d1  %>% ggplot(aes(x=t1, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.9) + geom_smooth(colour='blue') + facet_wrap(~meastype)
pdf("~/.julia/dev/Examples/datafusion/figs/vis_data_periodic.pdf",width=7,height=5)
pl4
dev.off()
pl4 <- d1  %>% ggplot(aes(x=t1, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.9) + geom_smooth(colour='blue') + facet_wrap(~meastype)+
ylab("time elapsed")
pl4 <- d1  %>% ggplot(aes(x=t1, y=y,colour=meastype)) + geom_point(size=0.6,alpha=0.9) + geom_smooth(colour='blue') + facet_wrap(~meastype)+
xlab("time elapsed") + ylab("concentration")
pdf("~/.julia/dev/Examples/datafusion/figs/vis_data_periodic.pdf",width=7,height=5)
pl4
dev.off()
pl4 + geom_hline(yintercept = 0)
